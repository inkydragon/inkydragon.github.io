<!DOCTYPE html>
<html lang="zh-cn">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="Mirantis 家的 OpenStack Fuel 套装单机部署踩坑记录">




  <meta name="keywords" content="OpenStack,">




  <link rel="alternate" href="/atom.xml" title="0u0' lab | Hexo">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.4.x">



<link rel="canonical" href="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/">


<meta name="description" content="Mirantis 家的 OpenStack Fuel 套装单机部署踩坑记录">
<meta name="keywords" content="OpenStack">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenStack Fuel 9.0 单机部署小记">
<meta property="og:url" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/index.html">
<meta property="og:site_name" content="0u0&#39; lab | Hexo">
<meta property="og:description" content="Mirantis 家的 OpenStack Fuel 套装单机部署踩坑记录">
<meta property="og:locale" content="zh-cn">
<meta property="og:image" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/fuel.png">
<meta property="og:image" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/master-finish.png">
<meta property="og:image" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/VBox-HostOnly.png">
<meta property="og:image" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/NIC-not_found.png">
<meta property="og:image" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/active-bootstrap.png">
<meta property="og:image" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/ssh-tunnel.png">
<meta property="og:image" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/keystone-timeout.png">
<meta property="og:image" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/horizon_dashboard.png">
<meta property="og:updated_time" content="2018-12-21T11:52:16.518Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="OpenStack Fuel 9.0 单机部署小记">
<meta name="twitter:description" content="Mirantis 家的 OpenStack Fuel 套装单机部署踩坑记录">
<meta name="twitter:image" content="https://blog.wo-class.cn/OpenStack-Fuel-9-0-单机部署小记/fuel.png">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.4.x">



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">





<script>
  var CONFIG = {
    search: true,
    searchPath: "/search.xml",
    fancybox: true,
    toc: true,
  }
</script>




  



    <title> OpenStack Fuel 9.0 单机部署小记 · 0u0' lab | Hexo </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">0u0' lab | Hexo</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            Tags
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            Categories
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">0u0' lab | Hexo</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
      
        <li class="menu-search">
          <form>
            <i class="iconfont icon-search" id="open-search"></i>
            <input type="text" class="search-input" id="search-input">
            <i class="iconfont icon-close" id="close-search"></i>
          </form>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          OpenStack Fuel 9.0 单机部署小记
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年7月27日
        </span>
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Ref-Links"><span class="toc-text">Ref Links</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Fuel-配置概述"><span class="toc-text">Fuel 配置概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#虚拟机硬件配置"><span class="toc-text">虚拟机硬件配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-requirements"><span class="toc-text">Network requirements</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#主节点网络配置"><span class="toc-text">主节点网络配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#安装步骤"><span class="toc-text">安装步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-0-安装镜像的下载"><span class="toc-text">Part 0 安装镜像的下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【Part-I】master-主节点的配置"><span class="toc-text">【Part I】master/主节点的配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-网络的规划与配置"><span class="toc-text">1.1 网络的规划与配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-master-虚拟机的设置"><span class="toc-text">1.2 master 虚拟机的设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-master-的安装"><span class="toc-text">1.3 master 的安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-bootstrap-镜像的制作"><span class="toc-text">1.4 bootstrap 镜像的制作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【Part-II】node-子节点的建立"><span class="toc-text">【Part II】node/子节点的建立</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-node-虚拟机的配置"><span class="toc-text">2.1 node 虚拟机的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-fuel-dashboard-的配置"><span class="toc-text">2.2 fuel dashboard 的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-配置分发-deploy"><span class="toc-text">2.3 配置分发/deploy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#【Part-III】horizon-平台的使用"><span class="toc-text">【Part III】horizon 平台的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-openstack-健康检查"><span class="toc-text">3.1 openstack 健康检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-云主机实例的建立"><span class="toc-text">3.2 云主机实例的建立</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#注意事项"><span class="toc-text">注意事项</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#常见错误"><span class="toc-text">常见错误</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <img src="/OpenStack-Fuel-9-0-单机部署小记/fuel.png">
<p>OpenStack Fuel 是Mirantis为OpenStack定制的自动部署软件(套装)，使用fuel配置OpenStack只需要配置master/主节点，并在主节点安装完成后在fuel dashboard/控制面板配置好整个OpenStack系统，即可通过fuel自动给个node/子节点部署系统(默认为Ubuntu)并安装、配置openstack。</p>
<a id="more"></a>
<h1 id="Ref-Links"><a href="#Ref-Links" class="headerlink" title="Ref Links"></a>Ref Links</h1><p><strong>推荐阅读</strong></p>
<ol start="0">
<li><a href="https://pom.nops.cloud/deployment_tool/fuel.html" target="_blank" rel="noopener">Fuel | 深入理解OpenStack自动化部署</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_936291410102wi29.html" target="_blank" rel="noopener">漫漫求索Openstack之路—Fuel 9.0 详细安装步骤（排坑版）<em>Alove</em>新浪博客</a></li>
<li>【Fuel 9.2】<a href="https://docs.mirantis.com/openstack/fuel/fuel-9.2/quickstart-guide/qs-intro.html" target="_blank" rel="noopener">Mirantis Documentation: Introduction</a></li>
<li>【Fuel 11.0】<a href="https://docs.openstack.org/fuel-docs/latest/userdocs/fuel-install-guide.html" target="_blank" rel="noopener">OpenStack Docs: Fuel Installation Guide</a></li>
</ol>
<p><strong>网络规划/配置参考</strong></p>
<ol start="4">
<li><a href="http://blog.csdn.net/hchuchuan/article/details/52225660" target="_blank" rel="noopener">Mirantis OpenStack 9.0 在 VirtualBox上的部署安装 - hchuchuan - CSDN博客</a></li>
<li><a href="http://www.cnblogs.com/yudar/p/4630758.html" target="_blank" rel="noopener">Fuel 30 分钟快速安装OpenStack - Yudar - 博客园</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/21864362" target="_blank" rel="noopener">OPNFV在双网卡物理机群上的部署（FUEL） - 知乎专栏</a></li>
<li>【Ubuntu 镜像源修改】<a href="http://blog.csdn.net/Titan0427/article/details/51982609" target="_blank" rel="noopener">部署安装Mirantis OpenStack Fuel 9.0 - Titan0427的专栏 - CSDN博客</a></li>
<li>【MOS本地源配置】<a href="http://lib.csdn.net/article/openstack/54517" target="_blank" rel="noopener">Mirantis OpenStack Fuel—MOS本地源/bootstrap制作 - OpenStack知识库</a></li>
</ol>
<p><strong>Horizon 使用</strong></p>
<ul>
<li><a href="http://tianhunyongheng.blog.51cto.com/1446947/1607676" target="_blank" rel="noopener">使用Fuel安装OpenStack juno之三使用OpenStack创建云主机和Volume - 天魂永恒 - 51CTO技术博客</a></li>
<li><a href="http://blog.vsharing.com/wpskl/A1738986.html" target="_blank" rel="noopener">[原创]Mirantis OpenStack fuel web 安装 使用 - Architect - 畅享博客</a></li>
</ul>
<p><strong>错误处理</strong></p>
<ul>
<li><a href="http://blog.csdn.net/lwyeluo/article/details/53102508?locationNum=12&amp;fps=1" target="_blank" rel="noopener">ESXi服务器上利用Fuel部署Openstack错误解决 - lwyeluo的专栏 - CSDN博客</a></li>
</ul>
<h1 id="Fuel-配置概述"><a href="#Fuel-配置概述" class="headerlink" title="Fuel 配置概述"></a>Fuel 配置概述</h1><p>[翻译自ref-3]</p>
<h2 id="虚拟机硬件配置"><a href="#虚拟机硬件配置" class="headerlink" title="虚拟机硬件配置"></a>虚拟机硬件配置</h2><blockquote>
<p><strong>NOTE</strong>: 这里只谈一般的配置，具体针对虚拟机的配置见后</p>
</blockquote>
<p><strong>Master Node/主节点</strong>:<br>安装fuel的节点，用于初始化设置，分发配置，PXE启动从节点并给从节点提供IP</p>
<p>主节点配置要求：<a href="https://docs.openstack.org/fuel-docs/latest/userdocs/fuel-install-guide/sysreq/sysreq_fuel_master_node_hw_requirements.html" target="_blank" rel="noopener">OpenStack Docs: Fuel Master node hardware requirements</a></p>
<p>这里只看测试环境的：</p>
<ul>
<li>双核 CPU</li>
<li>2G RAM</li>
<li>1000M 网卡 x1</li>
<li>50GB 硬盘</li>
</ul>
<p><strong>Slave node/从节点</strong>:<br>从节点是依赖于主节点的：控制节点、计算节点、储存节点等</p>
<p>有四种从节点：</p>
<ul>
<li>Controller nodes/控制节点</li>
<li>Compute nodes/计算节点</li>
<li>Storage nodes/储存节点</li>
<li>Telemetry - MongoDB nodes/遥测节点</li>
</ul>
<p>对于测试环境只需要前两个节点(各1个)即可</p>
<p>参考配置：</p>
<ul>
<li>双核 CPU</li>
<li>2G 内存 (可以加到4G)</li>
<li>1000M 网卡 x3</li>
<li>>120G 硬盘 (or 64G x3)</li>
</ul>
<h2 id="Network-requirements"><a href="#Network-requirements" class="headerlink" title="Network requirements"></a><a href="https://docs.openstack.org/fuel-docs/latest/userdocs/fuel-install-guide/sysreq/sysreq_network_requirements.html" target="_blank" rel="noopener">Network requirements</a></h2><blockquote>
<p><strong>NOTE</strong> 以下配置均在Dashboard中进行</p>
</blockquote>
<p><strong>带VLAN分隔的Neutron</strong></p>
<p>至少三张网卡：</p>
<table>
<thead>
<tr>
<th style="text-align:left">NIC</th>
<th style="text-align:left">for …</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">eth0</td>
<td style="text-align:left">未标记的管理网络(PXE…)</td>
</tr>
<tr>
<td style="text-align:left">eth1</td>
<td style="text-align:left">&gt; Public/Floating</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">&gt; Management</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">&gt; Storage</td>
</tr>
<tr>
<td style="text-align:left">eth2</td>
<td style="text-align:left">Private network</td>
</tr>
</tbody>
</table>
<p><strong>带隧道分隔的Neutron</strong></p>
<p>omitted</p>
<p><strong>对Public network/公有网络的要求</strong></p>
<ul>
<li>Floating IP/<code>浮动IP</code>地址范围必须和Public IP/<code>公有IP</code>一同配置</li>
<li>每个Controller node/<code>控制节点</code>都需要一个<code>公有IP</code><ul>
<li>如果选中了 <em><code>Assign public network to all nodes</code></em> 选项<br>则需要为每一个从节点分配一个<code>公有IP</code></li>
</ul>
</li>
<li>还需要预留3个IP给：<ul>
<li>Virtual IP/<code>VIP</code> x2</li>
<li>default gateway/<code>默认网关</code> x1</li>
</ul>
</li>
<li>如果打开了 Neutron DVR 选项，则每个计算节点还需要额外的一个IP</li>
<li>注意插件可能需要额外的IP</li>
</ul>
<p><strong>对Storage and Management networks/储存、管理网络的要求</strong></p>
<ul>
<li>这个网络为内网，因此需要内网IP段</li>
</ul>
<p><strong>Neutron L2 和 L3</strong></p>
<ul>
<li>每个project/项目所用的网络，需要独一无二的 <code>VLAN ID</code> (分隔ID)</li>
<li>处于安全原因，Admin project network/<code>管理网络</code> <em>孤立于</em> 其余网络(公有/私有网络)</li>
<li>包括Admin project/<code>管理项目</code>在内的每一个项目都需要一个<code>浮动IP</code></li>
<li>虚拟机直连到外部网络需要一个<code>浮动IP</code></li>
<li><code>浮动IP</code>地址不应与<code>公有网络</code>地址重合</li>
<li>如果不使用默认DNS服务器，则应指定guest OS DNS servers</li>
</ul>
<h2 id="主节点网络配置"><a href="#主节点网络配置" class="headerlink" title="主节点网络配置"></a>主节点网络配置</h2><ul>
<li>主节点应该能正常联网，一边下载、制作PXE启动镜像。</li>
<li>也可以在不联网的条件下，通过本地镜像制作PXE启动镜像。</li>
</ul>
<h1 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h1><p>安装可大致分为几类：</p>
<ul>
<li>物理机安装<br>比照虚拟机的安装，相应配置增加</li>
<li>虚拟机安装<ul>
<li>VirtualBox<ul>
<li>手工安装 【见下】</li>
<li>【官方推荐】Fuel 9.0 + VBox + 自动安装脚本<br> <a href="https://docs.mirantis.com/openstack/fuel/fuel-9.2/quickstart-guide/qs-install-scripts.html" target="_blank" rel="noopener">Mirantis Documentation: Install Mirantis OpenStack using the Mirantis VirtualBox scripts</a></li>
</ul>
</li>
<li><a href="https://docs.openstack.org/fuel-docs/latest/userdocs/fuel-install-guide/vsphere_intro.html#vsphere-intro" target="_blank" rel="noopener">OpenStack Docs: Install Fuel on VMware vSphere</a></li>
<li>Hyper-V (教程较少)<ul>
<li><a href="https://www.mirantis.com/blog/hyper-v-integration-openstack-platform/" target="_blank" rel="noopener">Hyper-V integration in OpenStack platform | Mirantis</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>【安装过程概述】<br>详细的过程建议参考ref部分-推荐阅读的教程</p>
</blockquote>
<h2 id="Part-0-安装镜像的下载"><a href="#Part-0-安装镜像的下载" class="headerlink" title="Part 0 安装镜像的下载"></a>Part 0 安装镜像的下载</h2><ul>
<li>【Fuel 9.0 ~ 9.2 有VBox自动安装脚本】<a href="https://www.mirantis.com/software/openstack/download/" target="_blank" rel="noopener">Download OpenStack Solutions</a></li>
<li>【Fuel 11.0 &amp; 12.0】<a href="https://www.fuel-infra.org/#fuelget" target="_blank" rel="noopener">Fuel Community project - Deployment and Management Automation for OpenStack</a></li>
</ul>
<p>选用第一种 Fuel 9.0 + VBox 并通过脚本安装时。<br>可能会遇到 <code>Failed to create the host-only adapter</code> 以及类似的的错误，<br>这个错误是一个已知的VBox Bug，在最新版中仍未修复，目前无直接解决办法，可以考虑绕过网络配置，详见【常见错误】的相关错误</p>
<h2 id="【Part-I】master-主节点的配置"><a href="#【Part-I】master-主节点的配置" class="headerlink" title="【Part I】master/主节点的配置"></a>【Part I】master/主节点的配置</h2><h3 id="1-1-网络的规划与配置"><a href="#1-1-网络的规划与配置" class="headerlink" title="1.1 网络的规划与配置"></a>1.1 网络的规划与配置</h3><h3 id="1-2-master-虚拟机的设置"><a href="#1-2-master-虚拟机的设置" class="headerlink" title="1.2 master 虚拟机的设置"></a>1.2 master 虚拟机的设置</h3><h3 id="1-3-master-的安装"><a href="#1-3-master-的安装" class="headerlink" title="1.3 master 的安装"></a>1.3 master 的安装</h3><h3 id="1-4-bootstrap-镜像的制作"><a href="#1-4-bootstrap-镜像的制作" class="headerlink" title="1.4 bootstrap 镜像的制作"></a>1.4 bootstrap 镜像的制作</h3><h2 id="【Part-II】node-子节点的建立"><a href="#【Part-II】node-子节点的建立" class="headerlink" title="【Part II】node/子节点的建立"></a>【Part II】node/子节点的建立</h2><h3 id="2-1-node-虚拟机的配置"><a href="#2-1-node-虚拟机的配置" class="headerlink" title="2.1 node 虚拟机的配置"></a>2.1 node 虚拟机的配置</h3><h3 id="2-2-fuel-dashboard-的配置"><a href="#2-2-fuel-dashboard-的配置" class="headerlink" title="2.2 fuel dashboard 的配置"></a>2.2 fuel dashboard 的配置</h3><h3 id="2-3-配置分发-deploy"><a href="#2-3-配置分发-deploy" class="headerlink" title="2.3 配置分发/deploy"></a>2.3 配置分发/deploy</h3><h2 id="【Part-III】horizon-平台的使用"><a href="#【Part-III】horizon-平台的使用" class="headerlink" title="【Part III】horizon 平台的使用"></a>【Part III】horizon 平台的使用</h2><h3 id="3-1-openstack-健康检查"><a href="#3-1-openstack-健康检查" class="headerlink" title="3.1 openstack 健康检查"></a>3.1 openstack 健康检查</h3><h3 id="3-2-云主机实例的建立"><a href="#3-2-云主机实例的建立" class="headerlink" title="3.2 云主机实例的建立"></a>3.2 云主机实例的建立</h3><h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><blockquote>
<p><strong>NOTE</strong>: 针对易出错的地方单独列出checklist，以便于检查</p>
</blockquote>
<ul>
<li><p>[ ] 虚拟机的选择<br>注意虚拟机之间的冲突 Hyper-V 打开时，VirtualBox、VMware均不能正常工作，<br>有时还会导致蓝屏(参见【常见错误】蓝屏 <code>0x0000003B</code>)<br>Fuel 官方推荐用 VBox，并提供了相应的自动安装、配置脚本。</p>
</li>
<li><p>[ ] 虚拟网络(网卡/交换机)的配置<br>各虚拟机网络配置方式不同，参数也有变化。<br>例如：</p>
<ul>
<li>VBox 设置网卡时，会将IP设置为形如 <code>10.20.0.1</code>的样子</li>
<li>VMware 则会设置为 <code>10.20.0.0</code><br><strong>注意配置统一</strong><br>建议配置之前画出网络拓扑图，并标注出功能/用途，再配置</li>
</ul>
</li>
<li><p>[ ] master 的配置<br>硬盘大小>64G<br>不然安装时会提示硬盘不够大</p>
</li>
<li><p>[ ] master 的安装<br>一定要等待安装完成，否则会出现不可预料的错误.<br><strong>完成的标志</strong>: <code>tty1</code>出现</p>
<img src="/OpenStack-Fuel-9-0-单机部署小记/master-finish.png">
</li>
<li><p>[ ] node 的配置<br>硬盘>120G</p>
</li>
<li><p>[ ] 网卡状态<br>检查各虚拟机网卡状态，down掉的网卡手动up<br>在虚拟机重启/安装完系统/应用完配置后均要检查网卡状态。<br>查看down掉的网卡：<code>ifconfig -a</code> 显示，而<code>ifconfig</code>不显示的<br>如果有<code>ifconfig &lt;enp0sx&gt; up</code>起来(<code>&lt;enp0sx&gt;</code>为网卡名)</p>
</li>
<li><p>[ ] 镜像的准备<br>注意activate(<code>fuel-bootstrap activate</code>)相关的bootstrap<br>参考：ref-5</p>
</li>
<li><p>[ ] 检查网络配置【之后不可更改】<br>NTP服务器设为master(推荐)<br>注意ip段无冲突(默认的是无冲突的，更改时注意，务必同时参考网络配置的要求)</p>
</li>
</ul>
<h1 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h1><ul>
<li><p><code>error: Failed to create the host-only adapter</code></p>
<blockquote>
<p>VBox version 5.1.24 &amp; 5.1.26</p>
</blockquote>
<p>使用官方自动安装、配置脚本时可能会遇到如下错误：</p>
<img src="/OpenStack-Fuel-9-0-单机部署小记/VBox-HostOnly.png" title="VBox-HostOnly">
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Deleting old interfaces if exists...</span><br><span class="line">...eting host-only interface: VirtualBox Host-Only Ethernet Adapter</span><br><span class="line">VBoxManage.exe: error: The host network interface named &apos;VirtualBox Host-Only Et&apos; could not be found</span><br><span class="line">VBoxManage.exe: error: Details: code E_INVALIDARG (0x80070057), component HostWrap, interface IHost, callee IUnknown</span><br><span class="line">VBoxManage.exe: error: Context: &quot;FindHostNetworkInterfaceByName(Bstr(pszName).raw(), hif.asOutParam())&quot; at line 139 of file VBoxManageHostonly.cpp</span><br><span class="line">&quot; was not removed. Aborting...x Host-Only Ethernet Adapter</span><br></pre></td></tr></table></figure>
<p>可能的解决方案：</p>
<blockquote><p>Simple solution: <strong>Delete the already created (default) Host only Ethernet Adapter</strong> from VirtualBox Preferences and run sh launch.sh (if you received error while installing Mirantis Openstack package).</p>
<footer><strong>@Javed Mulani</strong><cite><a href="https://stackoverflow.com/questions/31765581/the-host-network-interface-with-the-given-name-could-not-be-found" target="_blank" rel="noopener">—— vagrant - The host network interface with the given name could not be found - Stack Overflow</a></cite></footer></blockquote>
<p>删除已有的网卡,<br>再次运行脚本</p>
<p>依旧报错</p>
<img src="/OpenStack-Fuel-9-0-单机部署小记/NIC-not_found.png" title="NIC-not_found">
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Creating host-only interface...</span><br><span class="line">0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%</span><br><span class="line">Fatal error. Interface VirtualBox Host-Only Ethernet Adapter does not exist after creation. Exiting</span><br></pre></td></tr></table></figure>
<p>根据以下链接，认为此bug为已知的、未修复的bug，</p>
<p>Bug 相关：</p>
<ul>
<li><a href="https://forums.virtualbox.org/viewtopic.php?f=6&amp;t=82989" target="_blank" rel="noopener">virtualbox.org • View topic - try to use scripts to create VirtualBox Host-Only Ethernet Adapter does not exist after creation.</a></li>
<li><a href="https://www.virtualbox.org/ticket/15019" target="_blank" rel="noopener">#15019 (Unable to create Host-Only Network in Windows 10) – Oracle VM VirtualBox</a></li>
</ul>
<p>【 <strong>可能的解决思路</strong>：】<br>注释掉<code>launch.sh</code>中的<code>./actions/create-interfaces.sh || exit 1</code><br>手工创建网络，然后执行安装脚本</p>
</li>
<li><p>开虚拟机 蓝屏 <code>0x0000003B</code><br>虚拟机冲突,只留一个要用的虚拟机，关闭其他的。<br> (一般为 hyper-v 和其他虚拟机冲突，因为他会默认将整个系统虚拟化)</p>
<ul>
<li><a href="https://forums.virtualbox.org/viewtopic.php?f=38&amp;t=77134" target="_blank" rel="noopener">virtualbox.org • View topic - system_service_exception</a>
</li>
</ul>
</li>
<li><p><code>fuel-bootstrap list</code> 结果为空<br>【适用于手工生成镜像。若使用了已有的镜像，可能是镜像损坏】<br>在生成镜像(<code>fuel-bootstrap build</code>)后，镜像还放在<code>tmp</code>里，需要手工导入<br><code>fuel-bootstrap import /tmp/&lt;bootstrap-id&gt;</code>然后再次list就可以看见了。<br>然后激活镜像<code>fuel-bootstrap activate &lt;bootstrap-id&gt;</code></p>
<img src="/OpenStack-Fuel-9-0-单机部署小记/active-bootstrap.png">
</li>
<li><p>连接不上 Fuel Web UI (10.20.0.2:8448)<br>检查主节点及子节点网卡是否有<code>down</code>掉的(<code>ifconfig -a</code> 显示，而<code>ifconfig</code>不显示的)，<br>如果有<code>ifconfig &lt;enp0sx&gt; up</code>起来(<code>&lt;enp0sx&gt;</code>为网卡名)</p>
<p>若主机与虚拟机可以互<code>ping</code><br>可尝试设置SSH隧道访问</p>
<img src="/OpenStack-Fuel-9-0-单机部署小记/ssh-tunnel.png">
</li>
<li><p><code>Timeout waiting for host &#39;10.109.6.1&#39; status to become &#39;up&#39; after 60 seconds!</code><br>公有网关设置有误/网关不回应ICMP包(ping包)</p>
<p>先对照的网络配置要求检查Fuel Web UI的配置是否有误，检查网络连通性。<br>如果用本机做网关，则应在防火墙中打开ICMP回显。<br>(可直接关闭防火墙/ <strong>不推荐</strong>)</p>
</li>
<li><p><code>(/Stage[main]/Main/Exec[sync_time_shell]/returns) failed: /bin/bash &quot;/etc/puppet/shell_manifests/sync_time_command.sh&quot; Excuted failed</code><br>NTP服务配置有误，务必设置为master的IP (默认为 <code>10.20.0.2</code>)</p>
</li>
<li><p><code>Command: &#39;openstack [ .... ]&#39; has been running for more then 20 seconds!</code></p>
<img src="/OpenStack-Fuel-9-0-单机部署小记/keystone-timeout.png">
<p>一般是虚拟机性能不行。<br>查看各虚拟机，资源占用情况(<code>top</code> or <code>htop</code>)<br>若CPU/内存占用过大，务必关机后增加配置。<br>并检查网卡up情况</p>
</li>
<li><p><code>unable to establish connection to keystone endpoint</code><br>horizon_dashboard 登录不了</p>
<img src="/OpenStack-Fuel-9-0-单机部署小记/horizon_dashboard.png">
<p>简单方法，重启各虚拟机</p>
<p>一般方法，检查master上的keystone服务是否正常运行，并查看各虚拟机，资源占用情况(<code>top</code> or <code>htop</code>)<br>CPU/内存占用过大，务必关机后增加配置。</p>
</li>
</ul>

      
    </div>

    
      
      



      
      
    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/OpenStack/">OpenStack</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/Try-Git/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Try Git!</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/论运算符优先级的重要性/">
        <span class="next-text nav-default">论运算符优先级的重要性</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
  </div>


        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/inkydragon" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
    
    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">woclass</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  
  




    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.4.x"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.4.x"></script>

    
  <script type="text/html" id="search-result">
    <article class="post">
      <header class="post-header">
        <h1 class="post-title">
          <a href="$url$" class="post-link">
            $title$
          </a>
        </h1>
      </header>
      <div class="post-content">
        $content$
        <div class="read-more">
          <a href="$url$" class="read-more-link">
            阅读更多
          </a>
        </div>
      </div>
    </article>
  </script>
  <script type="text/html" id="no-search-result">
    <div class="no-result">
      <h2>No result found!</h2>
    </div>
  </script>
  <script type="text/javascript" src="/js/src/search.js?v=2.4.x"></script>

  </body>
</html>
